"""
Content Generator - –ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
====================================================

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø–æ–º–æ–≥–∞–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞,
—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç–∞—Ç–µ–π –∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python -m automation.content_generator --topic "–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∫–æ—Ñ–µ–º–∞—à–∏–Ω—É"

"""

import os
from datetime import datetime
from typing import List, Dict
import json


# –¢–µ–º—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
CONTENT_TOPICS = {
    "coffee": [
        "–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∫–æ—Ñ–µ –¥–ª—è –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã",
        "–ê—Ä–∞–±–∏–∫–∞ vs –†–æ–±—É—Å—Ç–∞: –≤ —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞",
        "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è –∫–æ—Ñ–µ: –ª—É—á—à–∏–µ —Ä–µ–≥–∏–æ–Ω—ã",
        "–°—Ç–µ–ø–µ–Ω–∏ –æ–±–∂–∞—Ä–∫–∏ –∫–æ—Ñ–µ",
        "–ö–∞–∫ —á–∏—Ç–∞—Ç—å –¥–µ–≥—É—Å—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–æ—Ç—ã",
        "Blasercafe: –æ–±–∑–æ—Ä –ª–∏–Ω–µ–π–∫–∏",
        "–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∫–æ—Ñ–µ",
        "–ü—Ä–∞–≤–∏–ª–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ—Ñ–µ",
        "–ü–æ–º–æ–ª –∫–æ—Ñ–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤",
        "Specialty coffee: —á—Ç–æ —ç—Ç–æ",
    ],
    "equipment": [
        "–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ—Ñ–µ–º–∞—à–∏–Ω–∞–º Delonghi",
        "–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∫–æ—Ñ–µ–º–∞—à–∏–Ω—É –¥–ª—è –¥–æ–º–∞",
        "–¢–æ–ø-5 –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã",
        "–ö–∞–ø—Å—É–ª—å–Ω–∞—è vs –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ñ–µ–º–∞—à–∏–Ω–∞",
        "–û–±–∑–æ—Ä –º–æ–¥–µ–ª–µ–π Delonghi 2025",
        "–ë—é–¥–∂–µ—Ç–Ω—ã–µ –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã: –Ω–∞ —á—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ",
        "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ñ–∏—Å–∞",
        "–ö–æ—Ñ–µ–º–æ–ª–∫–∏: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è",
        "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è –∫–æ—Ñ–µ–º–∞—à–∏–Ω",
        "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è vs —Ä—É—á–Ω–∞—è —á–∏—Å—Ç–∫–∞",
    ],
    "service": [
        "7 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —á—Ç–æ –∫–æ—Ñ–µ–º–∞—à–∏–Ω–µ –Ω—É–∂–µ–Ω —Ä–µ–º–æ–Ω—Ç",
        "–î–µ–∫–∞–ª—å—Ü–∏–Ω–∞—Ü–∏—è: –∫–∞–∫ –∏ –∫–æ–≥–¥–∞ –ø—Ä–æ–≤–æ–¥–∏—Ç—å",
        "–ß–∏—Å—Ç–∫–∞ –∑–∞–≤–∞—Ä–æ—á–Ω–æ–≥–æ –±–ª–æ–∫–∞",
        "–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å vs —á–∞—Å—Ç–Ω–∏–∫–∏",
        "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∑–∞–ø—á–∞—Å—Ç–∏ Delonghi",
        "–ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Ä–µ–º–æ–Ω—Ç: —É—Å–ª–æ–≤–∏—è",
        "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞: –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–ª–æ–º–æ–∫",
        "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–ª–æ–º–æ–∫: —á–µ–∫-–ª–∏—Å—Ç",
        "–°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–∏–ø–∏—á–Ω—ã—Ö —Ä–µ–º–æ–Ω—Ç–æ–≤",
        "–ö–∞–∫ –ø—Ä–æ–¥–ª–∏—Ç—å —Å—Ä–æ–∫ —Å–ª—É–∂–±—ã –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã",
    ],
    "recipes": [
        "–ò–¥–µ–∞–ª—å–Ω—ã–π —ç—Å–ø—Ä–µ—Å—Å–æ: –ø–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç",
        "–ö–∞–ø—É—á–∏–Ω–æ: –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∞",
        "–õ–∞—Ç—Ç–µ: –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∫—Ä–∞—Å–∏–≤—É—é –ø–µ–Ω—É",
        "–ê–º–µ—Ä–∏–∫–∞–Ω–æ vs –ª—É–Ω–≥–æ: –≤ —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞",
        "–§–ª—ç—Ç —É–∞–π—Ç: –∞–≤—Å—Ç—Ä–∞–ª–∏–π—Å–∫–∞—è –∫–ª–∞—Å—Å–∏–∫–∞",
        "–†–∞—Ñ –∫–æ—Ñ–µ: —Ä—É—Å—Å–∫–æ–µ –∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏–µ",
        "–ê–π—Å-–ª–∞—Ç—Ç–µ: —Ä–µ—Ü–µ–ø—Ç—ã –¥–ª—è –ª–µ—Ç–∞",
        "–ö–æ–ª–¥ –±—Ä—é: —Ö–æ–ª–æ–¥–Ω–æ–µ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏–µ",
        "–õ–∞—Ç—Ç–µ-–∞—Ä—Ç: –±–∞–∑–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏",
        "–ö–æ—Ñ–µ –ø–æ-—Ç—É—Ä–µ—Ü–∫–∏: —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±",
    ]
}


class ContentGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è"""
    
    def __init__(self):
        self.templates = self._load_templates()
    
    def _load_templates(self) -> Dict:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã —Å—Ç–∞—Ç–µ–π"""
        return {
            "how-to": """
# {title}

## –í–≤–µ–¥–µ–Ω–∏–µ
[–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª—è]

## –ß—Ç–æ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è
- –ü—É–Ω–∫—Ç 1
- –ü—É–Ω–∫—Ç 2
- –ü—É–Ω–∫—Ç 3

## –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: [–ù–∞–∑–≤–∞–Ω–∏–µ]
[–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]

### –®–∞–≥ 2: [–ù–∞–∑–≤–∞–Ω–∏–µ]
[–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]

### –®–∞–≥ 3: [–ù–∞–∑–≤–∞–Ω–∏–µ]
[–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]

## –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏
1. [–û—à–∏–±–∫–∞ –∏ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å]
2. [–û—à–∏–±–∫–∞ –∏ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å]

## –°–æ–≤–µ—Ç—ã –æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ DimKava
[–ù–∞—à–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏]

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
[–†–µ–∑—é–º–µ –∏ –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é]

---
*–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å? –ü–æ—Å–µ—Ç–∏—Ç–µ –Ω–∞—à –º–∞–≥–∞–∑–∏–Ω-–∫–æ—Ñ–µ–π–Ω—é DimKava –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏.*
""",
            "review": """
# {title}

## –û–±–∑–æ—Ä
[–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]

## –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä 1**: –∑–Ω–∞—á–µ–Ω–∏–µ
- **–ü–∞—Ä–∞–º–µ—Ç—Ä 2**: –∑–Ω–∞—á–µ–Ω–∏–µ
- **–ü–∞—Ä–∞–º–µ—Ç—Ä 3**: –∑–Ω–∞—á–µ–Ω–∏–µ

## –ü–ª—é—Å—ã
‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ 1
‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ 2
‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ 3

## –ú–∏–Ω—É—Å—ã
‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ 1
‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ 2

## –î–ª—è –∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç
[–û–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏]

## –ù–∞—à –≤–µ—Ä–¥–∏–∫—Ç
[–ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏]

## –ì–¥–µ –∫—É–ø–∏—Ç—å
[–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ DimKava]

---
*–í –º–∞–≥–∞–∑–∏–Ω–µ DimKava –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π.*
""",
            "comparison": """
# {title}

## –í–≤–µ–¥–µ–Ω–∏–µ
[–ß—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏ –∑–∞—á–µ–º]

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –í–∞—Ä–∏–∞–Ω—Ç 1 | –í–∞—Ä–∏–∞–Ω—Ç 2 |
|----------|-----------|-----------|
| –¶–µ–Ω–∞ | ... | ... |
| –ö–∞—á–µ—Å—Ç–≤–æ | ... | ... |
| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ | ... | ... |

## –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

### –ü–∞—Ä–∞–º–µ—Ç—Ä 1
[–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ]

### –ü–∞—Ä–∞–º–µ—Ç—Ä 2
[–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ]

## –ß—Ç–æ –≤—ã–±—Ä–∞—Ç—å?
[–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤]

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
[–ò—Ç–æ–≥–æ–≤—ã–µ –º—ã—Å–ª–∏]

---
*–ù—É–∂–Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è? –≠–∫—Å–ø–µ—Ä—Ç—ã DimKava –ø–æ–º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.*
""",
        }
    
    def get_all_topics(self) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ–º—ã"""
        all_topics = []
        for category, topics in CONTENT_TOPICS.items():
            all_topics.extend(topics)
        return all_topics
    
    def generate_content_plan(self, months: int = 3) -> Dict:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–ª–∞–Ω –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ N –º–µ—Å—è—Ü–µ–≤
        
        Args:
            months: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—è—Ü–µ–≤
        
        Returns:
            Dict —Å –ø–ª–∞–Ω–æ–º –ø—É–±–ª–∏–∫–∞—Ü–∏–π
        """
        topics = self.get_all_topics()
        articles_per_month = 8  # 2 —Å—Ç–∞—Ç—å–∏ –≤ –Ω–µ–¥–µ–ª—é
        
        plan = {
            "period": f"{months} –º–µ—Å—è—Ü–µ–≤",
            "total_articles": months * articles_per_month,
            "articles_per_month": articles_per_month,
            "months": []
        }
        
        topic_index = 0
        for month in range(1, months + 1):
            month_plan = {
                "month": month,
                "articles": []
            }
            
            for week in range(1, 5):  # 4 –Ω–µ–¥–µ–ª–∏
                for _ in range(2):  # 2 —Å—Ç–∞—Ç—å–∏ –≤ –Ω–µ–¥–µ–ª—é
                    if topic_index < len(topics):
                        month_plan["articles"].append({
                            "week": week,
                            "topic": topics[topic_index],
                            "status": "planned"
                        })
                        topic_index += 1
            
            plan["months"].append(month_plan)
        
        return plan
    
    def create_article_template(self, title: str, template_type: str = "how-to") -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç —à–∞–±–ª–æ–Ω —Å—Ç–∞—Ç—å–∏
        
        Args:
            title: –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏
            template_type: —Ç–∏–ø —à–∞–±–ª–æ–Ω–∞ (how-to, review, comparison)
        
        Returns:
            str —Å —à–∞–±–ª–æ–Ω–æ–º —Å—Ç–∞—Ç—å–∏
        """
        template = self.templates.get(template_type, self.templates["how-to"])
        return template.format(title=title)
    
    def save_template(self, content: str, filename: str = None):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —à–∞–±–ª–æ–Ω –≤ —Ñ–∞–π–ª"""
        if filename is None:
            filename = f"article_{datetime.now().strftime('%Y%m%d_%H%M%S')}.md"
        
        os.makedirs("templates/articles", exist_ok=True)
        filepath = os.path.join("templates/articles", filename)
        
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"‚úÖ –®–∞–±–ª–æ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {filepath}")
        return filepath
    
    def save_content_plan(self, plan: Dict, filename: str = None):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–ª–∞–Ω –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        if filename is None:
            filename = f"content_plan_{datetime.now().strftime('%Y%m%d')}.json"
        
        os.makedirs("templates", exist_ok=True)
        filepath = os.path.join("templates", filename)
        
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(plan, f, ensure_ascii=False, indent=2)
        
        print(f"‚úÖ –ü–ª–∞–Ω –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {filepath}")
        return filepath


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üìù –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ DimKava\n")
    
    generator = ContentGenerator()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–ª–∞–Ω –Ω–∞ 3 –º–µ—Å—è—Ü–∞
    print("–°–æ–∑–¥–∞—é –ø–ª–∞–Ω –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ 3 –º–µ—Å—è—Ü–∞...")
    plan = generator.generate_content_plan(months=3)
    generator.save_content_plan(plan)
    
    print(f"\nüìä –ü–ª–∞–Ω —Å–æ–∑–¥–∞–Ω:")
    print(f"   –ü–µ—Ä–∏–æ–¥: {plan['period']}")
    print(f"   –í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π: {plan['total_articles']}")
    print(f"   –°—Ç–∞—Ç–µ–π –≤ –º–µ—Å—è—Ü: {plan['articles_per_month']}")
    
    # –°–æ–∑–¥–∞–µ–º —à–∞–±–ª–æ–Ω –ø–µ—Ä–≤–æ–π —Å—Ç–∞—Ç—å–∏
    print("\nüìÑ –°–æ–∑–¥–∞—é —à–∞–±–ª–æ–Ω –ø–µ—Ä–≤–æ–π —Å—Ç–∞—Ç—å–∏...")
    first_topic = plan["months"][0]["articles"][0]["topic"]
    template = generator.create_article_template(first_topic, "how-to")
    generator.save_template(template, "example_article.md")
    
    print("\n‚úÖ –ì–æ—Ç–æ–≤–æ!")
    print("\n–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ–º—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:")
    for category, topics in CONTENT_TOPICS.items():
        print(f"\n{category.upper()} ({len(topics)} —Ç–µ–º)")


if __name__ == "__main__":
    main()

